{% extends 'base.html' %}

{% block title %}Admin Dashboard{% endblock %}

{% block extra_css %}
<!-- Chart.js for analytics -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<!-- Date range picker for filtering -->
<script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />
<style>
/* Enhanced Admin Dashboard Styling with Responsive Design */
.stat-card {
    border-radius: 10px;
    border: none;
    transition: all 0.3s ease;
    height: 100%;
}
.stat-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
}
.stat-icon {
    width: 48px;
    height: 48px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 12px;
    font-size: 24px;
}
@media (max-width: 767.98px) {
    .stat-icon {
        width: 40px;
        height: 40px;
        font-size: 18px;
    }
}
.trend-indicator {
    display: inline-flex;
    align-items: center;
    font-size: 0.8rem;
    padding: 2px 8px;
    border-radius: 12px;
}
.trend-up {
    background-color: rgba(40, 167, 69, 0.1);
    color: #28a745;
}
.trend-down {
    background-color: rgba(220, 53, 69, 0.1);
    color: #dc3545;
}
.control-panel-card {
    border: none;
    border-radius: 10px;
}
.filter-bar {
    background-color: rgba(0, 0, 0, 0.05);
    padding: 15px;
    margin-bottom: 20px;
    border-radius: 10px;
}
@media (max-width: 767.98px) {
    .filter-bar {
        padding: 10px;
    }
}
.admin-nav {
    background: linear-gradient(to right, #8e44ad, #3498db);
    padding: 15px;
    margin: -20px -15px 20px;
    border-radius: 0 0 15px 15px;
    color: white;
}
@media (max-width: 767.98px) {
    .admin-nav {
        padding: 10px;
        margin: -15px -15px 15px;
    }
    .admin-nav h2 {
        font-size: 1.5rem;
    }
}
.chart-container {
    position: relative;
    height: 300px;
}
@media (max-width: 767.98px) {
    .chart-container {
        height: 200px;
    }
}
.nav-pills .nav-link.active {
    background-color: #8e44ad;
}
.resource-distribution {
    height: 250px;
}
@media (max-width: 767.98px) {
    .resource-distribution {
        height: auto;
    }
}
.user-action-btn {
    padding: 0.25rem 0.5rem;
    font-size: 0.8rem;
}
.admin-tab-content {
    padding: 20px 0;
}
@media (max-width: 767.98px) {
    .admin-tab-content {
        padding: 15px 0;
    }
}

/* Content Management Styles */
.content-item {
    border-left: 3px solid transparent;
    transition: all 0.2s ease;
}
.content-item:hover {
    border-left-color: #8e44ad;
    background-color: rgba(142, 68, 173, 0.05);
}
.content-actions {
    opacity: 0.7;
    transition: opacity 0.2s ease;
}
.content-item:hover .content-actions {
    opacity: 1;
}
.task-preview {
    background-color: rgba(0, 0, 0, 0.05);
    border-radius: 8px;
    padding: 15px;
}
.task-status-badge {
    font-size: 0.75rem;
    padding: 2px 8px;
    border-radius: 50px;
}
.drag-handle {
    cursor: move;
    color: #6c757d;
}
.content-editor {
    background-color: #1e1e1e;
    border-radius: 8px;
    border: 1px solid #3d3d3d;
}
.preview-container {
    border: 1px dashed #6c757d;
    border-radius: 8px;
    min-height: 100px;
}
.content-nav .nav-link {
    padding: 8px 12px;
    border-radius: 0;
    border-left: 3px solid transparent;
}
.content-nav .nav-link.active {
    background-color: rgba(142, 68, 173, 0.1);
    border-left-color: #8e44ad;
}
</style>
{% endblock %}

{% block content %}
<!-- Admin Navigation Bar -->
<div class="admin-nav d-flex justify-content-between align-items-center mb-4">
    <div>
        <h2 class="mb-0"><i class="fas fa-shield-alt me-2"></i>Pixel Plaza Admin</h2>
        <p class="mb-0 text-white-50">Administrative Dashboard & Control Panel</p>
    </div>
    <div>
        {% if authenticated %}
        <a href="{{ url_for('export_csv') }}" class="btn btn-light">
            <i class="fas fa-file-csv me-2"></i>Export Airdrop Data
        </a>
        {% endif %}
    </div>
</div>

{% if not authenticated %}
<div class="row mt-5">
    <div class="col-md-6 mx-auto">
        <div class="card border-0">
            <div class="card-header bg-dark">
                <h5 class="mb-0">Admin Authentication</h5>
            </div>
            <div class="card-body">
                <form method="post">
                    <div class="mb-3">
                        <label for="password" class="form-label">Admin Password</label>
                        <input type="password" class="form-control" id="password" name="password" required>
                    </div>
                    <button type="submit" class="btn btn-primary">Login</button>
                </form>
            </div>
        </div>
    </div>
</div>
{% else %}
<!-- Admin Tabs -->
<!-- Admin Navigation - Enhanced for responsive design -->
<div class="admin-navigation mb-4">
    <!-- Desktop Navigation Pills -->
    <ul class="nav nav-pills d-none d-md-flex" id="adminTab" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="dashboard-tab" data-bs-toggle="tab" data-bs-target="#dashboard" type="button" role="tab" aria-controls="dashboard" aria-selected="true">
                <i class="fas fa-chart-line me-2"></i>Dashboard
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="users-tab" data-bs-toggle="tab" data-bs-target="#users" type="button" role="tab" aria-controls="users" aria-selected="false">
                <i class="fas fa-users me-2"></i>User Management
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="economy-tab" data-bs-toggle="tab" data-bs-target="#economy" type="button" role="tab" aria-controls="economy" aria-selected="false">
                <i class="fas fa-coins me-2"></i>Economy Control
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="content-tab" data-bs-toggle="tab" data-bs-target="#content" type="button" role="tab" aria-controls="content" aria-selected="false">
                <i class="fas fa-edit me-2"></i>Content Management
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="airdrop-tab" data-bs-toggle="tab" data-bs-target="#airdrop" type="button" role="tab" aria-controls="airdrop" aria-selected="false">
                <i class="fas fa-parachute-box me-2"></i>Airdrop Planning
            </button>
        </li>
    </ul>
    
    <!-- Mobile Navigation Dropdown -->
    <div class="d-md-none dropdown mb-3">
        <button class="btn btn-primary dropdown-toggle w-100" type="button" id="adminTabMobile" data-bs-toggle="dropdown" aria-expanded="false">
            <i class="fas fa-bars me-2"></i>Admin Menu
        </button>
        <ul class="dropdown-menu w-100" aria-labelledby="adminTabMobile">
            <li>
                <button class="dropdown-item active" id="dashboard-tab-mobile" data-bs-toggle="tab" data-bs-target="#dashboard" type="button" role="tab" aria-controls="dashboard" aria-selected="true">
                    <i class="fas fa-chart-line me-2"></i>Dashboard
                </button>
            </li>
            <li>
                <button class="dropdown-item" id="users-tab-mobile" data-bs-toggle="tab" data-bs-target="#users" type="button" role="tab" aria-controls="users" aria-selected="false">
                    <i class="fas fa-users me-2"></i>User Management
                </button>
            </li>
            <li>
                <button class="dropdown-item" id="economy-tab-mobile" data-bs-toggle="tab" data-bs-target="#economy" type="button" role="tab" aria-controls="economy" aria-selected="false">
                    <i class="fas fa-coins me-2"></i>Economy Control
                </button>
            </li>
            <li>
                <button class="dropdown-item" id="content-tab-mobile" data-bs-toggle="tab" data-bs-target="#content" type="button" role="tab" aria-controls="content" aria-selected="false">
                    <i class="fas fa-edit me-2"></i>Content Management
                </button>
            </li>
            <li>
                <button class="dropdown-item" id="airdrop-tab-mobile" data-bs-toggle="tab" data-bs-target="#airdrop" type="button" role="tab" aria-controls="airdrop" aria-selected="false">
                    <i class="fas fa-parachute-box me-2"></i>Airdrop Planning
                </button>
            </li>
        </ul>
    </div>
</div>

<div class="tab-content admin-tab-content" id="adminTabContent">
    <!-- Dashboard Tab -->
    <div class="tab-pane fade show active" id="dashboard" role="tabpanel" aria-labelledby="dashboard-tab">
        <!-- Key Metrics Row -->
        <div class="row mb-4">
            <!-- Total Users Metric -->
            <div class="col-md-3 mb-4">
                <div class="card bg-dark stat-card">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-start mb-3">
                            <div>
                                <h6 class="text-muted mb-1">Total Users</h6>
                                <h3 class="mb-0">{{ users|length }}</h3>
                            </div>
                            <div class="stat-icon bg-primary">
                                <i class="fas fa-users"></i>
                            </div>
                        </div>
                        <div class="trend-indicator trend-up">
                            <i class="fas fa-arrow-up me-1"></i> 12% this week
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Active Users Metric -->
            <div class="col-md-3 mb-4">
                <div class="card bg-dark stat-card">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-start mb-3">
                            <div>
                                <h6 class="text-muted mb-1">Active Today</h6>
                                <h3 class="mb-0">{{ active_today }}</h3>
                            </div>
                            <div class="stat-icon bg-success">
                                <i class="fas fa-user-check"></i>
                            </div>
                        </div>
                        <div class="trend-indicator trend-up">
                            <i class="fas fa-arrow-up me-1"></i> 8% vs yesterday
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Token Economy Metric -->
            <div class="col-md-3 mb-4">
                <div class="card bg-dark stat-card">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-start mb-3">
                            <div>
                                <h6 class="text-muted mb-1">$PXPT Circulating</h6>
                                <h3 class="mb-0">{{ total_tokens|round(2) }}</h3>
                            </div>
                            <div class="stat-icon bg-warning">
                                <i class="fas fa-coins"></i>
                            </div>
                        </div>
                        <div class="trend-indicator trend-up">
                            <i class="fas fa-arrow-up me-1"></i> 5% this week
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Buildings Metric -->
            <div class="col-md-3 mb-4">
                <div class="card bg-dark stat-card">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-start mb-3">
                            <div>
                                <h6 class="text-muted mb-1">Total Buildings</h6>
                                <h3 class="mb-0">{{ total_buildings }}</h3>
                            </div>
                            <div class="stat-icon bg-info">
                                <i class="fas fa-building"></i>
                            </div>
                        </div>
                        <div class="trend-indicator trend-up">
                            <i class="fas fa-arrow-up me-1"></i> 15% this week
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Charts Row -->
        <div class="row mb-4">
            <!-- User Growth Chart -->
            <div class="col-md-6 mb-4">
                <div class="card bg-dark stat-card">
                    <div class="card-header bg-dark border-0">
                        <h5 class="mb-0"><i class="fas fa-chart-line me-2"></i>User Growth</h5>
                    </div>
                    <div class="card-body">
                        <div class="chart-container">
                            <canvas id="userGrowthChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Token Distribution Chart -->
            <div class="col-md-6 mb-4">
                <div class="card bg-dark stat-card">
                    <div class="card-header bg-dark border-0">
                        <h5 class="mb-0"><i class="fas fa-chart-pie me-2"></i>Token Distribution</h5>
                    </div>
                    <div class="card-body">
                        <div class="chart-container">
                            <canvas id="tokenDistributionChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Activity & Resource Charts -->
        <div class="row mb-4">
            <!-- Activity Breakdown -->
            <div class="col-md-6 mb-4">
                <div class="card bg-dark stat-card">
                    <div class="card-header bg-dark border-0">
                        <h5 class="mb-0"><i class="fas fa-chart-bar me-2"></i>Activity Breakdown</h5>
                    </div>
                    <div class="card-body">
                        <div class="chart-container">
                            <canvas id="activityChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Resource Heatmap -->
            <div class="col-md-6 mb-4">
                <div class="card bg-dark stat-card">
                    <div class="card-header bg-dark border-0">
                        <h5 class="mb-0"><i class="fas fa-th me-2"></i>Resource Distribution</h5>
                    </div>
                    <div class="card-body">
                        <div class="resource-distribution">
                            <div class="row mb-3">
                                <div class="col-3 text-center">
                                    <div class="icon-circle" style="background-color: #3498db;">
                                        <i class="fas fa-paint-brush"></i>
                                    </div>
                                    <p class="mt-2">Pixels</p>
                                    <h5>{{ total_pixels }}</h5>
                                </div>
                                <div class="col-3 text-center">
                                    <div class="icon-circle" style="background-color: #2ecc71;">
                                        <i class="fas fa-bolt"></i>
                                    </div>
                                    <p class="mt-2">Energy</p>
                                    <h5>{{ total_energy }}</h5>
                                </div>
                                <div class="col-3 text-center">
                                    <div class="icon-circle" style="background-color: #f39c12;">
                                        <i class="fas fa-hammer"></i>
                                    </div>
                                    <p class="mt-2">Materials</p>
                                    <h5>{{ total_materials }}</h5>
                                </div>
                                <div class="col-3 text-center">
                                    <div class="icon-circle" style="background-color: #9b59b6;">
                                        <i class="fas fa-gem"></i>
                                    </div>
                                    <p class="mt-2">Gems</p>
                                    <h5>{{ total_gems }}</h5>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Users Tab -->
    <div class="tab-pane fade" id="users" role="tabpanel" aria-labelledby="users-tab">
        <!-- User Filtering -->
        <div class="filter-bar mb-4">
            <div class="row align-items-center">
                <div class="col-md-3 mb-3 mb-md-0">
                    <input type="text" class="form-control" id="userSearch" placeholder="Search users...">
                </div>
                <div class="col-md-3 mb-3 mb-md-0">
                    <select class="form-select" id="filterActivity">
                        <option value="all">All Activity</option>
                        <option value="today">Active Today</option>
                        <option value="week">Active This Week</option>
                        <option value="inactive">Inactive (7+ days)</option>
                    </select>
                </div>
                <div class="col-md-3 mb-3 mb-md-0">
                    <select class="form-select" id="filterWallet">
                        <option value="all">All Wallet Status</option>
                        <option value="yes">Wallet Registered</option>
                        <option value="no">No Wallet</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <button class="btn btn-primary w-100" id="applyFilters">
                        <i class="fas fa-filter me-2"></i>Apply Filters
                    </button>
                </div>
            </div>
        </div>
        
        <!-- User Management Table -->
        <div class="card bg-dark stat-card">
            <div class="card-header bg-dark border-0 d-flex justify-content-between align-items-center">
                <h5 class="mb-0"><i class="fas fa-users me-2"></i>User Management</h5>
                <div class="btn-group">
                    <button class="btn btn-sm btn-outline-light" id="exportUserData">
                        <i class="fas fa-download me-1"></i>Export
                    </button>
                    <button class="btn btn-sm btn-outline-light dropdown-toggle" data-bs-toggle="dropdown">
                        <i class="fas fa-cog me-1"></i>Actions
                    </button>
                    <ul class="dropdown-menu dropdown-menu-end">
                        <li><a class="dropdown-item" href="#"><i class="fas fa-envelope me-2"></i>Message All</a></li>
                        <li><a class="dropdown-item" href="#"><i class="fas fa-gift me-2"></i>Reward All</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item text-danger" href="#"><i class="fas fa-ban me-2"></i>Reset Inactive</a></li>
                    </ul>
                </div>
            </div>
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-hover mb-0" id="userTable">
                        <thead>
                            <tr>
                                <th>
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="selectAllUsers">
                                    </div>
                                </th>
                                <th>Username</th>
                                <th>Telegram ID</th>
                                <th>Wallet</th>
                                <th>Level</th>
                                <th>$PXPT</th>
                                <th>Buildings</th>
                                <th>Last Active</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for user, game_state in users %}
                                <tr>
                                    <td>
                                        <div class="form-check">
                                            <input class="form-check-input user-select" type="checkbox" value="{{ user.id }}">
                                        </div>
                                    </td>
                                    <td>{{ user.username }}</td>
                                    <td>{{ user.telegram_id }}</td>
                                    <td>
                                        {% if user.wallet_address %}
                                            <span class="text-success">{{ user.wallet_address[:6] }}...{{ user.wallet_address[-4:] }}</span>
                                        {% else %}
                                            <span class="text-danger">Not set</span>
                                        {% endif %}
                                    </td>
                                    <td>{{ game_state.level }}</td>
                                    <td>{{ game_state.token_balance|round(2) }}</td>
                                    <td>{{ game_state.buildings_owned }}</td>
                                    <td>{{ game_state.last_active.strftime('%Y-%m-%d %H:%M') if game_state.last_active else 'Never' }}</td>
                                    <td>
                                        <div class="btn-group">
                                            <button class="btn btn-sm btn-outline-info user-action-btn">
                                                <i class="fas fa-eye"></i>
                                            </button>
                                            <button class="btn btn-sm btn-outline-warning user-action-btn">
                                                <i class="fas fa-gift"></i>
                                            </button>
                                            <button class="btn btn-sm btn-outline-danger user-action-btn">
                                                <i class="fas fa-ban"></i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="card-footer bg-dark border-0">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <span class="text-muted">Showing {{ users|length }} users</span>
                    </div>
                    <nav aria-label="User pagination">
                        <ul class="pagination pagination-sm mb-0">
                            <li class="page-item disabled">
                                <a class="page-link" href="#" tabindex="-1" aria-disabled="true">Previous</a>
                            </li>
                            <li class="page-item active"><a class="page-link" href="#">1</a></li>
                            <li class="page-item"><a class="page-link" href="#">2</a></li>
                            <li class="page-item"><a class="page-link" href="#">3</a></li>
                            <li class="page-item">
                                <a class="page-link" href="#">Next</a>
                            </li>
                        </ul>
                    </nav>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Economy Control Tab -->
    <div class="tab-pane fade" id="economy" role="tabpanel" aria-labelledby="economy-tab">
        <div class="row mb-4">
            <!-- Economy Control Panel -->
            <div class="col-lg-6 mb-4">
                <div class="card bg-dark stat-card">
                    <div class="card-header bg-dark border-0">
                        <h5 class="mb-0"><i class="fas fa-sliders-h me-2"></i>Economy Control Panel</h5>
                    </div>
                    <div class="card-body">
                        <form id="economyControlForm">
                            <div class="mb-4">
                                <h6 class="text-primary mb-3">Resource Generation Rates</h6>
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label class="form-label">Mining Reward Multiplier</label>
                                        <div class="input-group">
                                            <input type="number" class="form-control" value="1.0" step="0.1" min="0.1" max="5.0">
                                            <span class="input-group-text"><i class="fas fa-times"></i></span>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Art Reward Multiplier</label>
                                        <div class="input-group">
                                            <input type="number" class="form-control" value="1.0" step="0.1" min="0.1" max="5.0">
                                            <span class="input-group-text"><i class="fas fa-times"></i></span>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Building Income Multiplier</label>
                                        <div class="input-group">
                                            <input type="number" class="form-control" value="1.0" step="0.1" min="0.1" max="5.0">
                                            <span class="input-group-text"><i class="fas fa-times"></i></span>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Energy Regeneration Rate</label>
                                        <div class="input-group">
                                            <input type="number" class="form-control" value="10" step="1" min="1" max="50">
                                            <span class="input-group-text">per hour</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mb-4">
                                <h6 class="text-warning mb-3">Building & Upgrade Costs</h6>
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label class="form-label">Mine Base Cost</label>
                                        <div class="input-group">
                                            <input type="number" class="form-control" value="50" step="5" min="10">
                                            <span class="input-group-text">$PXPT</span>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Studio Base Cost</label>
                                        <div class="input-group">
                                            <input type="number" class="form-control" value="80" step="5" min="10">
                                            <span class="input-group-text">$PXPT</span>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Upgrade Cost Multiplier</label>
                                        <div class="input-group">
                                            <input type="number" class="form-control" value="1.5" step="0.1" min="1.1">
                                            <span class="input-group-text"><i class="fas fa-level-up-alt"></i></span>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Material Cost per Level</label>
                                        <div class="input-group">
                                            <input type="number" class="form-control" value="20" step="5" min="5">
                                            <span class="input-group-text">materials</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mb-4">
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <h6 class="text-info mb-0">Game Events</h6>
                                    <button type="button" class="btn btn-sm btn-outline-info">
                                        <i class="fas fa-plus me-1"></i>Create New Event
                                    </button>
                                </div>
                                <div class="table-responsive">
                                    <table class="table table-sm table-hover">
                                        <thead>
                                            <tr>
                                                <th>Event Name</th>
                                                <th>Type</th>
                                                <th>Status</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>Mining Boom</td>
                                                <td><span class="badge bg-success">Positive</span></td>
                                                <td><span class="badge bg-warning">Scheduled</span></td>
                                                <td>
                                                    <button class="btn btn-sm btn-outline-light">Edit</button>
                                                    <button class="btn btn-sm btn-outline-danger">Cancel</button>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>Pixel Festival</td>
                                                <td><span class="badge bg-success">Positive</span></td>
                                                <td><span class="badge bg-success">Active</span></td>
                                                <td>
                                                    <button class="btn btn-sm btn-outline-warning">End Early</button>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>Resource Scarcity</td>
                                                <td><span class="badge bg-danger">Negative</span></td>
                                                <td><span class="badge bg-secondary">Inactive</span></td>
                                                <td>
                                                    <button class="btn btn-sm btn-outline-light">Edit</button>
                                                    <button class="btn btn-sm btn-outline-success">Activate</button>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            
                            <div class="d-grid gap-2">
                                <button type="button" class="btn btn-primary">
                                    <i class="fas fa-save me-2"></i>Save Economy Settings
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            
            <!-- Market Analytics -->
            <div class="col-lg-6 mb-4">
                <div class="card bg-dark stat-card">
                    <div class="card-header bg-dark border-0">
                        <h5 class="mb-0"><i class="fas fa-chart-area me-2"></i>Market Analytics</h5>
                    </div>
                    <div class="card-body">
                        <div class="chart-container mb-4">
                            <canvas id="marketPriceChart"></canvas>
                        </div>
                        
                        <h6 class="text-warning mb-3">Resource Market Prices</h6>
                        <div class="row g-3 mb-4">
                            <div class="col-md-4">
                                <div class="card bg-dark p-3 border border-info border-opacity-25 rounded-3">
                                    <div class="d-flex justify-content-between align-items-center mb-2">
                                        <span><i class="fas fa-paint-brush text-info me-2"></i>Pixels</span>
                                        <span class="trend-indicator trend-up"><i class="fas fa-arrow-up me-1"></i>3%</span>
                                    </div>
                                    <h5 class="mb-0">2.45 $PXPT</h5>
                                    <small class="text-muted">per 100 units</small>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card bg-dark p-3 border border-warning border-opacity-25 rounded-3">
                                    <div class="d-flex justify-content-between align-items-center mb-2">
                                        <span><i class="fas fa-hammer text-warning me-2"></i>Materials</span>
                                        <span class="trend-indicator trend-down"><i class="fas fa-arrow-down me-1"></i>2%</span>
                                    </div>
                                    <h5 class="mb-0">5.80 $PXPT</h5>
                                    <small class="text-muted">per 100 units</small>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="card bg-dark p-3 border border-purple border-opacity-25 rounded-3">
                                    <div class="d-flex justify-content-between align-items-center mb-2">
                                        <span><i class="fas fa-gem text-purple me-2"></i>Gems</span>
                                        <span class="trend-indicator trend-up"><i class="fas fa-arrow-up me-1"></i>12%</span>
                                    </div>
                                    <h5 class="mb-0">24.60 $PXPT</h5>
                                    <small class="text-muted">per unit</small>
                                </div>
                            </div>
                        </div>
                        
                        <h6 class="text-warning mb-3">Transaction Volume (24h)</h6>
                        <div class="progress mb-1" style="height: 25px;">
                            <div class="progress-bar bg-info" style="width: 45%;">Pixels: 45%</div>
                            <div class="progress-bar bg-warning" style="width: 35%;">Materials: 35%</div>
                            <div class="progress-bar bg-purple" style="width: 20%;">Gems: 20%</div>
                        </div>
                        <div class="d-flex justify-content-between">
                            <small class="text-muted">Total Volume: 12,450 $PXPT</small>
                            <small class="text-muted">Transactions: 128</small>
                        </div>
                        
                        <hr class="my-4">
                        
                        <h6 class="text-warning mb-3">Market Intervention</h6>
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label class="form-label">Resource Type</label>
                                <select class="form-select">
                                    <option value="pixels">Pixels</option>
                                    <option value="materials">Materials</option>
                                    <option value="gems">Gems</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Action Type</label>
                                <select class="form-select">
                                    <option value="buy">Buy (Increase Price)</option>
                                    <option value="sell">Sell (Decrease Price)</option>
                                </select>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Amount</label>
                                <input type="number" class="form-control" value="500" step="100" min="100">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label">Target Price Change</label>
                                <div class="input-group">
                                    <input type="number" class="form-control" value="5" step="1" min="1" max="20">
                                    <span class="input-group-text">%</span>
                                </div>
                            </div>
                            <div class="col-12">
                                <button type="button" class="btn btn-warning w-100">
                                    <i class="fas fa-balance-scale me-2"></i>Execute Market Intervention
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Airdrop Planning Tab -->
    <!-- Content Management Tab -->
    <div class="tab-pane fade" id="content" role="tabpanel" aria-labelledby="content-tab">
        <div class="row">
            <div class="col-12 col-lg-3 mb-4">
                <!-- Content Navigation Sidebar -->
                <div class="card bg-dark stat-card">
                    <div class="card-header bg-dark border-0">
                        <h5 class="mb-0"><i class="fas fa-sitemap me-2"></i>Content Areas</h5>
                    </div>
                    <div class="card-body p-0">
                        <div class="list-group list-group-flush content-nav">
                            <a href="#tasks-section" class="list-group-item list-group-item-action active bg-transparent text-white" data-bs-toggle="list">
                                <i class="fas fa-tasks me-2"></i>Tasks & Quests
                            </a>
                            <a href="#announcements-section" class="list-group-item list-group-item-action bg-transparent text-white" data-bs-toggle="list">
                                <i class="fas fa-bullhorn me-2"></i>Announcements
                            </a>
                            <a href="#events-section" class="list-group-item list-group-item-action bg-transparent text-white" data-bs-toggle="list">
                                <i class="fas fa-calendar-alt me-2"></i>Game Events
                            </a>
                            <a href="#help-section" class="list-group-item list-group-item-action bg-transparent text-white" data-bs-toggle="list">
                                <i class="fas fa-question-circle me-2"></i>Help Content
                            </a>
                        </div>
                    </div>
                    <div class="card-footer bg-dark border-0">
                        <button class="btn btn-primary w-100" type="button" data-bs-toggle="modal" data-bs-target="#contentPreviewModal">
                            <i class="fas fa-eye me-2"></i>Preview Changes
                        </button>
                    </div>
                </div>
                
                <!-- Content Stats -->
                <div class="card bg-dark stat-card mt-4">
                    <div class="card-header bg-dark border-0">
                        <h5 class="mb-0"><i class="fas fa-chart-pie me-2"></i>Content Stats</h5>
                    </div>
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <span>Active Tasks</span>
                            <span class="badge bg-primary">{{ active_tasks|default(8) }}</span>
                        </div>
                        <div class="progress mb-3" style="height: 5px;">
                            <div class="progress-bar bg-primary" role="progressbar" style="width: 80%"></div>
                        </div>
                        
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <span>Announcements</span>
                            <span class="badge bg-info">{{ announcements|default(3) }}</span>
                        </div>
                        <div class="progress mb-3" style="height: 5px;">
                            <div class="progress-bar bg-info" role="progressbar" style="width: 30%"></div>
                        </div>
                        
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <span>Active Events</span>
                            <span class="badge bg-warning">{{ active_events|default(1) }}</span>
                        </div>
                        <div class="progress mb-3" style="height: 5px;">
                            <div class="progress-bar bg-warning" role="progressbar" style="width: 10%"></div>
                        </div>
                        
                        <div class="d-flex justify-content-between align-items-center">
                            <span>Help Articles</span>
                            <span class="badge bg-success">{{ help_articles|default(5) }}</span>
                        </div>
                        <div class="progress" style="height: 5px;">
                            <div class="progress-bar bg-success" role="progressbar" style="width: 50%"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-12 col-lg-9">
                <!-- Content Tab Content -->
                <div class="tab-content">
                    <!-- Tasks Section -->
                    <div class="tab-pane fade show active" id="tasks-section">
                        <div class="card bg-dark stat-card">
                            <div class="card-header bg-dark border-0 d-flex justify-content-between align-items-center">
                                <h5 class="mb-0"><i class="fas fa-tasks me-2"></i>Manage Tasks</h5>
                                <button class="btn btn-sm btn-success" data-bs-toggle="modal" data-bs-target="#createTaskModal">
                                    <i class="fas fa-plus me-2"></i>New Task
                                </button>
                            </div>
                            <div class="card-body">
                                <div class="filter-bar mb-3">
                                    <div class="row g-2">
                                        <div class="col-md-4">
                                            <input type="text" class="form-control" placeholder="Search tasks...">
                                        </div>
                                        <div class="col-md-3">
                                            <select class="form-select">
                                                <option value="all">All Types</option>
                                                <option value="one_time">One-time</option>
                                                <option value="daily">Daily</option>
                                                <option value="weekly">Weekly</option>
                                            </select>
                                        </div>
                                        <div class="col-md-3">
                                            <select class="form-select">
                                                <option value="all">All Status</option>
                                                <option value="active">Active</option>
                                                <option value="inactive">Inactive</option>
                                            </select>
                                        </div>
                                        <div class="col-md-2">
                                            <button class="btn btn-primary w-100">
                                                <i class="fas fa-filter"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Task List -->
                                <div class="task-list">
                                    {% for task in tasks|default([
                                        {'id': 1, 'name': 'Welcome Bonus', 'description': 'Create your account and receive a welcome bonus!', 'type': 'one_time', 'objective': 'registration', 'value': 1, 'active': True},
                                        {'id': 2, 'name': 'Daily Check-in', 'description': 'Check in daily to receive tokens', 'type': 'daily', 'objective': 'login', 'value': 1, 'active': True},
                                        {'id': 3, 'name': 'Mining Master', 'description': 'Mine 100 pixels in a single day', 'type': 'daily', 'objective': 'mining', 'value': 100, 'active': True},
                                        {'id': 4, 'name': 'Building Tycoon', 'description': 'Own 5 buildings', 'type': 'one_time', 'objective': 'building', 'value': 5, 'active': True},
                                        {'id': 5, 'name': 'Art Exhibition', 'description': 'Create 10 pixel arts', 'type': 'one_time', 'objective': 'pixel_art', 'value': 10, 'active': True},
                                        {'id': 6, 'name': 'Community Leader', 'description': 'Refer 3 friends', 'type': 'one_time', 'objective': 'referral', 'value': 3, 'active': True},
                                        {'id': 7, 'name': 'Weekly Collector', 'description': 'Collect from buildings 7 days in a row', 'type': 'weekly', 'objective': 'collection', 'value': 7, 'active': True},
                                        {'id': 8, 'name': 'Market Maker', 'description': 'Complete 5 market transactions in a week', 'type': 'weekly', 'objective': 'market', 'value': 5, 'active': False}
                                    ]) %}
                                    <div class="card mb-3 content-item">
                                        <div class="card-body">
                                            <div class="row align-items-center">
                                                <div class="col-auto">
                                                    <i class="fas fa-grip-vertical drag-handle"></i>
                                                </div>
                                                <div class="col-md-5">
                                                    <h5 class="mb-1">{{ task.name }}</h5>
                                                    <p class="mb-0 text-muted small">{{ task.description }}</p>
                                                </div>
                                                <div class="col-md-3">
                                                    <div class="badge bg-primary mb-1">{{ task.type }}</div>
                                                    <div class="d-flex align-items-center">
                                                        <span class="badge bg-info me-2">{{ task.objective }}</span>
                                                        <span class="small text-muted">× {{ task.value }}</span>
                                                    </div>
                                                </div>
                                                <div class="col-md-2">
                                                    <div class="form-check form-switch mb-1">
                                                        <input class="form-check-input" type="checkbox" id="task{{ task.id }}" {% if task.active %}checked{% endif %}>
                                                        <label class="form-check-label" for="task{{ task.id }}">
                                                            {% if task.active %}
                                                            <span class="text-success">Active</span>
                                                            {% else %}
                                                            <span class="text-danger">Inactive</span>
                                                            {% endif %}
                                                        </label>
                                                    </div>
                                                    <span class="badge bg-secondary">ID: {{ task.id }}</span>
                                                </div>
                                                <div class="col-md-1">
                                                    <div class="content-actions">
                                                        <button class="btn btn-sm btn-outline-primary mb-1" data-bs-toggle="modal" data-bs-target="#editTaskModal">
                                                            <i class="fas fa-edit"></i>
                                                        </button>
                                                        <button class="btn btn-sm btn-outline-danger">
                                                            <i class="fas fa-trash"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                                
                                <!-- Pagination -->
                                <nav aria-label="Task pagination" class="mt-4">
                                    <ul class="pagination justify-content-center">
                                        <li class="page-item disabled">
                                            <a class="page-link" href="#" tabindex="-1" aria-disabled="true">Previous</a>
                                        </li>
                                        <li class="page-item active"><a class="page-link" href="#">1</a></li>
                                        <li class="page-item"><a class="page-link" href="#">2</a></li>
                                        <li class="page-item"><a class="page-link" href="#">3</a></li>
                                        <li class="page-item">
                                            <a class="page-link" href="#">Next</a>
                                        </li>
                                    </ul>
                                </nav>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Announcements Section -->
                    <div class="tab-pane fade" id="announcements-section">
                        <div class="card bg-dark stat-card">
                            <div class="card-header bg-dark border-0 d-flex justify-content-between align-items-center">
                                <h5 class="mb-0"><i class="fas fa-bullhorn me-2"></i>Game Announcements</h5>
                                <button class="btn btn-sm btn-success" data-bs-toggle="modal" data-bs-target="#createAnnouncementModal">
                                    <i class="fas fa-plus me-2"></i>New Announcement
                                </button>
                            </div>
                            <div class="card-body">
                                <!-- Announcement List -->
                                <div class="announcement-list">
                                    {% for announcement in announcements|default([
                                        {'id': 1, 'title': 'Welcome to Pixel Plaza Token!', 'content': 'Welcome to our game! Earn tokens, build your empire, and prepare for the airdrop.', 'date': '2025-04-28', 'priority': 'high'},
                                        {'id': 2, 'title': 'New Features Released', 'content': 'We\'ve added new mining mechanics and pixel art creation tools. Check them out!', 'date': '2025-05-01', 'priority': 'medium'},
                                        {'id': 3, 'title': 'Upcoming Airdrop Details', 'content': 'The $PXPT airdrop is scheduled for May 10. Make sure your wallet is registered!', 'date': '2025-05-02', 'priority': 'high'}
                                    ]) %}
                                    <div class="card mb-3 content-item">
                                        <div class="card-body">
                                            <div class="row align-items-center">
                                                <div class="col-md-7">
                                                    <div class="d-flex align-items-center mb-2">
                                                        <h5 class="mb-0">{{ announcement.title }}</h5>
                                                        {% if announcement.priority == 'high' %}
                                                        <span class="badge bg-danger ms-2">Important</span>
                                                        {% elif announcement.priority == 'medium' %}
                                                        <span class="badge bg-warning ms-2">Announcement</span>
                                                        {% else %}
                                                        <span class="badge bg-info ms-2">Info</span>
                                                        {% endif %}
                                                    </div>
                                                    <p class="mb-0 text-muted">{{ announcement.content }}</p>
                                                </div>
                                                <div class="col-md-3 text-md-center">
                                                    <div class="small text-muted mb-1">Published on</div>
                                                    <div class="badge bg-secondary">{{ announcement.date }}</div>
                                                </div>
                                                <div class="col-md-2">
                                                    <div class="content-actions d-flex justify-content-end">
                                                        <button class="btn btn-sm btn-outline-primary me-2" data-bs-toggle="modal" data-bs-target="#editAnnouncementModal">
                                                            <i class="fas fa-edit"></i>
                                                        </button>
                                                        <button class="btn btn-sm btn-outline-success me-2">
                                                            <i class="fas fa-paper-plane"></i>
                                                        </button>
                                                        <button class="btn btn-sm btn-outline-danger">
                                                            <i class="fas fa-trash"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                                
                                <!-- New Announcement Form -->
                                <div class="card mt-4">
                                    <div class="card-header bg-dark">
                                        <h5 class="mb-0">Quick Announcement</h5>
                                    </div>
                                    <div class="card-body">
                                        <form>
                                            <div class="mb-3">
                                                <label class="form-label">Title</label>
                                                <input type="text" class="form-control" placeholder="Announcement title">
                                            </div>
                                            <div class="mb-3">
                                                <label class="form-label">Content</label>
                                                <textarea class="form-control" rows="3" placeholder="Announcement content"></textarea>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6 mb-3">
                                                    <label class="form-label">Priority</label>
                                                    <select class="form-select">
                                                        <option value="low">Low</option>
                                                        <option value="medium">Medium</option>
                                                        <option value="high">High</option>
                                                    </select>
                                                </div>
                                                <div class="col-md-6 mb-3">
                                                    <label class="form-label">Publish Date</label>
                                                    <input type="date" class="form-control">
                                                </div>
                                            </div>
                                            <div class="d-grid">
                                                <button type="button" class="btn btn-primary">
                                                    <i class="fas fa-paper-plane me-2"></i>Send Announcement
                                                </button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Game Events Section -->
                    <div class="tab-pane fade" id="events-section">
                        <div class="card bg-dark stat-card">
                            <div class="card-header bg-dark border-0 d-flex justify-content-between align-items-center">
                                <h5 class="mb-0"><i class="fas fa-calendar-alt me-2"></i>Game Events</h5>
                                <button class="btn btn-sm btn-success" data-bs-toggle="modal" data-bs-target="#createEventModal">
                                    <i class="fas fa-plus me-2"></i>New Event
                                </button>
                            </div>
                            <div class="card-body">
                                <div class="row mb-4">
                                    <div class="col-md-6">
                                        <div class="card bg-dark">
                                            <div class="card-body">
                                                <h5 class="card-title">Current Active Events</h5>
                                                <div class="list-group list-group-flush">
                                                    {% for event in active_events_list|default([
                                                        {'name': 'Mining Madness', 'description': 'Mining production increased by 50%', 'end_date': '2025-05-05'}
                                                    ]) %}
                                                    <div class="list-group-item bg-transparent text-white">
                                                        <div class="d-flex justify-content-between align-items-center">
                                                            <div>
                                                                <h6 class="mb-1">{{ event.name }}</h6>
                                                                <p class="mb-0 small text-muted">{{ event.description }}</p>
                                                            </div>
                                                            <div class="text-end">
                                                                <span class="badge bg-warning">Ends: {{ event.end_date }}</span>
                                                                <button class="btn btn-sm btn-outline-danger ms-2">
                                                                    <i class="fas fa-times"></i>
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    {% endfor %}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="card bg-dark">
                                            <div class="card-body">
                                                <h5 class="card-title">Upcoming Events</h5>
                                                <div class="list-group list-group-flush">
                                                    {% for event in upcoming_events|default([
                                                        {'name': 'Pixel Art Festival', 'description': 'Art creation rewards doubled', 'start_date': '2025-05-07', 'end_date': '2025-05-10'},
                                                        {'name': 'Building Bonanza', 'description': 'Building costs reduced by 20%', 'start_date': '2025-05-12', 'end_date': '2025-05-15'}
                                                    ]) %}
                                                    <div class="list-group-item bg-transparent text-white">
                                                        <div class="d-flex justify-content-between align-items-center">
                                                            <div>
                                                                <h6 class="mb-1">{{ event.name }}</h6>
                                                                <p class="mb-0 small text-muted">{{ event.description }}</p>
                                                            </div>
                                                            <div class="text-end">
                                                                <span class="badge bg-info">Starts: {{ event.start_date }}</span>
                                                                <button class="btn btn-sm btn-outline-primary ms-2">
                                                                    <i class="fas fa-edit"></i>
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    {% endfor %}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Event Creator -->
                                <div class="card">
                                    <div class="card-header bg-dark">
                                        <h5 class="mb-0">Quick Event Creator</h5>
                                    </div>
                                    <div class="card-body">
                                        <form>
                                            <div class="row">
                                                <div class="col-md-6 mb-3">
                                                    <label class="form-label">Event Name</label>
                                                    <input type="text" class="form-control" placeholder="Event name">
                                                </div>
                                                <div class="col-md-6 mb-3">
                                                    <label class="form-label">Event Type</label>
                                                    <select class="form-select">
                                                        <option value="seasonal">Seasonal</option>
                                                        <option value="special">Special</option>
                                                        <option value="crisis">Crisis (Negative)</option>
                                                        <option value="boom">Economic Boom</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="mb-3">
                                                <label class="form-label">Description</label>
                                                <textarea class="form-control" rows="2" placeholder="Event description"></textarea>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6 mb-3">
                                                    <label class="form-label">Start Date</label>
                                                    <input type="date" class="form-control">
                                                </div>
                                                <div class="col-md-6 mb-3">
                                                    <label class="form-label">End Date</label>
                                                    <input type="date" class="form-control">
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-3 mb-3">
                                                    <label class="form-label">Mining Mult.</label>
                                                    <input type="number" step="0.1" class="form-control" value="1.0">
                                                </div>
                                                <div class="col-md-3 mb-3">
                                                    <label class="form-label">Art Mult.</label>
                                                    <input type="number" step="0.1" class="form-control" value="1.0">
                                                </div>
                                                <div class="col-md-3 mb-3">
                                                    <label class="form-label">Building Mult.</label>
                                                    <input type="number" step="0.1" class="form-control" value="1.0">
                                                </div>
                                                <div class="col-md-3 mb-3">
                                                    <label class="form-label">Market Fee Mult.</label>
                                                    <input type="number" step="0.1" class="form-control" value="1.0">
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-3 mb-3">
                                                    <div class="form-check form-switch">
                                                        <input class="form-check-input" type="checkbox" id="affectTokens" checked>
                                                        <label class="form-check-label" for="affectTokens">Affects Tokens</label>
                                                    </div>
                                                </div>
                                                <div class="col-md-3 mb-3">
                                                    <div class="form-check form-switch">
                                                        <input class="form-check-input" type="checkbox" id="affectPixels">
                                                        <label class="form-check-label" for="affectPixels">Affects Pixels</label>
                                                    </div>
                                                </div>
                                                <div class="col-md-3 mb-3">
                                                    <div class="form-check form-switch">
                                                        <input class="form-check-input" type="checkbox" id="affectMaterials">
                                                        <label class="form-check-label" for="affectMaterials">Affects Materials</label>
                                                    </div>
                                                </div>
                                                <div class="col-md-3 mb-3">
                                                    <div class="form-check form-switch">
                                                        <input class="form-check-input" type="checkbox" id="affectGems">
                                                        <label class="form-check-label" for="affectGems">Affects Gems</label>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="d-grid">
                                                <button type="button" class="btn btn-primary">
                                                    <i class="fas fa-calendar-plus me-2"></i>Schedule Event
                                                </button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Help Content Section -->
                    <div class="tab-pane fade" id="help-section">
                        <div class="card bg-dark stat-card">
                            <div class="card-header bg-dark border-0 d-flex justify-content-between align-items-center">
                                <h5 class="mb-0"><i class="fas fa-question-circle me-2"></i>Help & Tutorial Content</h5>
                                <button class="btn btn-sm btn-success" data-bs-toggle="modal" data-bs-target="#createHelpModal">
                                    <i class="fas fa-plus me-2"></i>New Help Article
                                </button>
                            </div>
                            <div class="card-body">
                                <!-- Help Article List -->
                                <div class="help-list">
                                    {% for article in help_articles_list|default([
                                        {'id': 1, 'title': 'Getting Started', 'category': 'Tutorial', 'views': 245},
                                        {'id': 2, 'title': 'Mining Pixels Guide', 'category': 'Gameplay', 'views': 189},
                                        {'id': 3, 'title': 'Building Your Empire', 'category': 'Strategy', 'views': 167},
                                        {'id': 4, 'title': 'Pixel Art Creation Tips', 'category': 'Tutorial', 'views': 132},
                                        {'id': 5, 'title': 'Token Earning Strategies', 'category': 'Strategy', 'views': 221}
                                    ]) %}
                                    <div class="card mb-3 content-item">
                                        <div class="card-body">
                                            <div class="row align-items-center">
                                                <div class="col-md-6">
                                                    <h5 class="mb-0">{{ article.title }}</h5>
                                                    <span class="badge bg-info mt-1">{{ article.category }}</span>
                                                </div>
                                                <div class="col-md-3 text-md-center">
                                                    <div class="small text-muted mb-1">Views</div>
                                                    <div class="d-flex align-items-center justify-content-md-center">
                                                        <i class="fas fa-eye me-2 text-muted"></i>
                                                        <span>{{ article.views }}</span>
                                                    </div>
                                                </div>
                                                <div class="col-md-3">
                                                    <div class="content-actions d-flex justify-content-end">
                                                        <button class="btn btn-sm btn-outline-info me-2" data-bs-toggle="modal" data-bs-target="#viewHelpModal">
                                                            <i class="fas fa-eye"></i>
                                                        </button>
                                                        <button class="btn btn-sm btn-outline-primary me-2" data-bs-toggle="modal" data-bs-target="#editHelpModal">
                                                            <i class="fas fa-edit"></i>
                                                        </button>
                                                        <button class="btn btn-sm btn-outline-danger">
                                                            <i class="fas fa-trash"></i>
                                                        </button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                                
                                <!-- Help Article Editor -->
                                <div class="card mt-4">
                                    <div class="card-header bg-dark d-flex justify-content-between align-items-center">
                                        <h5 class="mb-0">Quick Help Article</h5>
                                        <div class="btn-group btn-group-sm">
                                            <button class="btn btn-outline-light" type="button">
                                                <i class="fas fa-bold"></i>
                                            </button>
                                            <button class="btn btn-outline-light" type="button">
                                                <i class="fas fa-italic"></i>
                                            </button>
                                            <button class="btn btn-outline-light" type="button">
                                                <i class="fas fa-list"></i>
                                            </button>
                                            <button class="btn btn-outline-light" type="button">
                                                <i class="fas fa-link"></i>
                                            </button>
                                            <button class="btn btn-outline-light" type="button">
                                                <i class="fas fa-image"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="card-body">
                                        <form>
                                            <div class="mb-3">
                                                <label class="form-label">Title</label>
                                                <input type="text" class="form-control" placeholder="Article title">
                                            </div>
                                            <div class="row mb-3">
                                                <div class="col-md-6">
                                                    <label class="form-label">Category</label>
                                                    <select class="form-select">
                                                        <option value="Tutorial">Tutorial</option>
                                                        <option value="Gameplay">Gameplay</option>
                                                        <option value="Strategy">Strategy</option>
                                                        <option value="FAQ">FAQ</option>
                                                    </select>
                                                </div>
                                                <div class="col-md-6">
                                                    <label class="form-label">Difficulty</label>
                                                    <select class="form-select">
                                                        <option value="Beginner">Beginner</option>
                                                        <option value="Intermediate">Intermediate</option>
                                                        <option value="Advanced">Advanced</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="mb-3">
                                                <label class="form-label">Content</label>
                                                <textarea class="form-control content-editor" rows="10" placeholder="Write your help article content here..."></textarea>
                                            </div>
                                            <div class="mb-3">
                                                <label class="form-label">Preview</label>
                                                <div class="preview-container p-3">
                                                    <p class="text-muted text-center">Content preview will appear here...</p>
                                                </div>
                                            </div>
                                            <div class="d-grid">
                                                <button type="button" class="btn btn-primary">
                                                    <i class="fas fa-save me-2"></i>Publish Help Article
                                                </button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Airdrop Tab -->
    <div class="tab-pane fade" id="airdrop" role="tabpanel" aria-labelledby="airdrop-tab">
        <div class="row mb-4">
            <!-- Airdrop Metrics -->
            <div class="col-md-4 mb-4">
                <div class="card bg-dark stat-card">
                    <div class="card-header bg-dark border-0">
                        <h5 class="mb-0"><i class="fas fa-parachute-box me-2"></i>Airdrop Summary</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-4">
                            <h6 class="text-muted mb-1">Total Eligible Users</h6>
                            {% set eligible_count = users|selectattr('0.wallet_address', 'defined')|selectattr('1.level', 'ge', 5)|selectattr('1.buildings_owned', 'ge', 1)|selectattr('1.pixel_art_created', 'ge', 1)|list|length %}
                            <h3 class="text-success mb-0">{{ eligible_count }}</h3>
                            <small class="text-muted">{{ ((eligible_count / users|length) * 100)|round }}% of all users</small>
                        </div>
                        
                        <div class="mb-4">
                            <h6 class="text-muted mb-1">Airdrop Allocation</h6>
                            <h3 class="text-warning mb-0">125,000 $PXPT</h3>
                            <small class="text-muted">Fixed allocation</small>
                        </div>
                        
                        <div class="mb-4">
                            <h6 class="text-muted mb-1">Per-User Average</h6>
                            {% if eligible_count > 0 %}
                            <h3 class="text-info mb-0">{{ (125000 / eligible_count)|round(2) }} $PXPT</h3>
                            {% else %}
                            <h3 class="text-info mb-0">0 $PXPT</h3>
                            {% endif %}
                            <small class="text-muted">Based on current eligibility</small>
                        </div>
                        
                        <div class="mb-4">
                            <h6 class="text-muted mb-1">Time Until Airdrop</h6>
                            <h3 class="text-danger mb-0" id="airdropCountdown">7 days 12 hours</h3>
                            <small class="text-muted">Scheduled for May 10, 2025</small>
                        </div>
                        
                        <hr class="my-4">
                        
                        <div class="d-grid gap-2">
                            <button type="button" class="btn btn-primary mb-2">
                                <i class="fas fa-cog me-2"></i>Configure Airdrop
                            </button>
                            <button type="button" class="btn btn-outline-warning">
                                <i class="fas fa-download me-2"></i>Download Snapshot
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Eligibility Criteria -->
            <div class="col-md-8 mb-4">
                <div class="card bg-dark stat-card">
                    <div class="card-header bg-dark border-0">
                        <h5 class="mb-0"><i class="fas fa-clipboard-check me-2"></i>Eligibility Criteria</h5>
                    </div>
                    <div class="card-body">
                        <div class="row mb-4">
                            <div class="col-md-6">
                                <div class="card bg-dark border border-light border-opacity-10 rounded-3 mb-3">
                                    <div class="card-body">
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="walletRequirement" checked>
                                            <label class="form-check-label" for="walletRequirement">
                                                <strong>Wallet Requirement</strong>
                                            </label>
                                        </div>
                                        <p class="text-muted small mb-0">User must register a wallet address to receive tokens</p>
                                        <div class="mt-2">
                                            <span class="badge bg-success">{{ users|selectattr('0.wallet_address', 'defined')|list|length }} users qualify</span>
                                            <span class="badge bg-secondary">{{ ((users|selectattr('0.wallet_address', 'defined')|list|length / users|length) * 100)|round }}%</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="card bg-dark border border-light border-opacity-10 rounded-3 mb-3">
                                    <div class="card-body">
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="levelRequirement" checked>
                                            <label class="form-check-label" for="levelRequirement">
                                                <strong>Level Requirement</strong>
                                            </label>
                                        </div>
                                        <div class="d-flex align-items-center">
                                            <p class="text-muted small mb-0 me-2">Minimum Level:</p>
                                            <input type="number" class="form-control form-control-sm" style="width: 70px;" value="5" min="1">
                                        </div>
                                        <div class="mt-2">
                                            <span class="badge bg-success">{{ users|selectattr('1.level', 'ge', 5)|list|length }} users qualify</span>
                                            <span class="badge bg-secondary">{{ ((users|selectattr('1.level', 'ge', 5)|list|length / users|length) * 100)|round }}%</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="card bg-dark border border-light border-opacity-10 rounded-3 mb-3">
                                    <div class="card-body">
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="buildingRequirement" checked>
                                            <label class="form-check-label" for="buildingRequirement">
                                                <strong>Building Requirement</strong>
                                            </label>
                                        </div>
                                        <div class="d-flex align-items-center">
                                            <p class="text-muted small mb-0 me-2">Minimum Buildings:</p>
                                            <input type="number" class="form-control form-control-sm" style="width: 70px;" value="1" min="1">
                                        </div>
                                        <div class="mt-2">
                                            <span class="badge bg-success">{{ users|selectattr('1.buildings_owned', 'ge', 1)|list|length }} users qualify</span>
                                            <span class="badge bg-secondary">{{ ((users|selectattr('1.buildings_owned', 'ge', 1)|list|length / users|length) * 100)|round }}%</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="card bg-dark border border-light border-opacity-10 rounded-3 mb-3">
                                    <div class="card-body">
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="artRequirement" checked>
                                            <label class="form-check-label" for="artRequirement">
                                                <strong>Pixel Art Requirement</strong>
                                            </label>
                                        </div>
                                        <div class="d-flex align-items-center">
                                            <p class="text-muted small mb-0 me-2">Minimum Created:</p>
                                            <input type="number" class="form-control form-control-sm" style="width: 70px;" value="1" min="1">
                                        </div>
                                        <div class="mt-2">
                                            <span class="badge bg-success">{{ users|selectattr('1.pixel_art_created', 'ge', 1)|list|length }} users qualify</span>
                                            <span class="badge bg-secondary">{{ ((users|selectattr('1.pixel_art_created', 'ge', 1)|list|length / users|length) * 100)|round }}%</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="card bg-dark border border-light border-opacity-10 rounded-3">
                                    <div class="card-body">
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="activityRequirement">
                                            <label class="form-check-label" for="activityRequirement">
                                                <strong>Activity Requirement</strong>
                                            </label>
                                        </div>
                                        <div class="d-flex align-items-center">
                                            <p class="text-muted small mb-0 me-2">Active Within:</p>
                                            <select class="form-select form-select-sm" style="width: 120px;">
                                                <option value="7">7 days</option>
                                                <option value="14">14 days</option>
                                                <option value="30">30 days</option>
                                            </select>
                                        </div>
                                        <div class="mt-2">
                                            <span class="badge bg-success">124 users qualify</span>
                                            <span class="badge bg-secondary">62%</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="card bg-dark border border-light border-opacity-10 rounded-3">
                                    <div class="card-body">
                                        <div class="form-check form-switch">
                                            <input class="form-check-input" type="checkbox" id="referralRequirement">
                                            <label class="form-check-label" for="referralRequirement">
                                                <strong>Referral Requirement</strong>
                                            </label>
                                        </div>
                                        <div class="d-flex align-items-center">
                                            <p class="text-muted small mb-0 me-2">Minimum Referrals:</p>
                                            <input type="number" class="form-control form-control-sm" style="width: 70px;" value="1" min="1">
                                        </div>
                                        <div class="mt-2">
                                            <span class="badge bg-success">58 users qualify</span>
                                            <span class="badge bg-secondary">29%</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="card bg-dark border border-success border-opacity-25 rounded-3 p-3">
                            <div class="d-flex justify-content-between align-items-start">
                                <div>
                                    <h5 class="text-success mb-1">Combined Eligibility</h5>
                                    <p class="text-muted mb-0">Users meeting all selected criteria</p>
                                </div>
                                <h3 class="text-success mb-0">{{ eligible_count }}</h3>
                            </div>
                            <div class="progress mt-3" style="height: 10px;">
                                <div class="progress-bar bg-success" style="width: {{ ((eligible_count / users|length) * 100)|round }}%;"></div>
                            </div>
                            <div class="d-flex justify-content-between mt-1">
                                <small class="text-muted">0</small>
                                <small class="text-muted">{{ users|length }} users</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="row">
            <div class="col-12 mb-4">
                <div class="card bg-dark stat-card">
                    <div class="card-header bg-dark border-0">
                        <h5 class="mb-0"><i class="fas fa-calculator me-2"></i>Airdrop Distribution Model</h5>
                    </div>
                    <div class="card-body">
                        <div class="row mb-4">
                            <div class="col-md-6">
                                <h6 class="text-warning mb-3">Distribution Method</h6>
                                <div class="form-check mb-2">
                                    <input class="form-check-input" type="radio" name="distributionMethod" id="methodEqual" checked>
                                    <label class="form-check-label" for="methodEqual">
                                        Equal Distribution
                                        <small class="d-block text-muted">All eligible users receive the same amount</small>
                                    </label>
                                </div>
                                <div class="form-check mb-2">
                                    <input class="form-check-input" type="radio" name="distributionMethod" id="methodLevel">
                                    <label class="form-check-label" for="methodLevel">
                                        Level-Based Distribution
                                        <small class="d-block text-muted">Higher level users receive more tokens</small>
                                    </label>
                                </div>
                                <div class="form-check mb-2">
                                    <input class="form-check-input" type="radio" name="distributionMethod" id="methodActivity">
                                    <label class="form-check-label" for="methodActivity">
                                        Activity-Based Distribution
                                        <small class="d-block text-muted">More active users receive more tokens</small>
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="distributionMethod" id="methodComplex">
                                    <label class="form-check-label" for="methodComplex">
                                        Complex Weighted Formula
                                        <small class="d-block text-muted">Combination of level, activity, and game metrics</small>
                                    </label>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <h6 class="text-warning mb-3">Airdrop Schedule</h6>
                                <div class="form-check mb-2">
                                    <input class="form-check-input" type="radio" name="scheduleMethod" id="scheduleOnce" checked>
                                    <label class="form-check-label" for="scheduleOnce">
                                        One-Time Distribution
                                        <small class="d-block text-muted">All tokens distributed at once</small>
                                    </label>
                                </div>
                                <div class="form-check mb-2">
                                    <input class="form-check-input" type="radio" name="scheduleMethod" id="scheduleMonthly">
                                    <label class="form-check-label" for="scheduleMonthly">
                                        Monthly Vesting
                                        <small class="d-block text-muted">Tokens released over 6 months</small>
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="scheduleMethod" id="scheduleCustom">
                                    <label class="form-check-label" for="scheduleCustom">
                                        Custom Schedule
                                        <small class="d-block text-muted">Define custom vesting periods</small>
                                    </label>
                                </div>
                                
                                <div class="mt-4">
                                    <label class="form-label">Airdrop Date</label>
                                    <input type="date" class="form-control" value="2025-05-10">
                                </div>
                            </div>
                        </div>
                        
                        <hr class="my-4">
                        
                        <div class="row">
                            <div class="col-md-6 mb-3 mb-md-0">
                                <button type="button" class="btn btn-warning w-100">
                                    <i class="fas fa-calculator me-2"></i>Simulate Distribution
                                </button>
                            </div>
                            <div class="col-md-6">
                                <button type="button" class="btn btn-success w-100">
                                    <i class="fas fa-save me-2"></i>Save Airdrop Configuration
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endif %}
{% endblock %}

{% block extra_js %}
<!-- Admin Dashboard Charts & Functionality -->
<script>
// Set up Chart.js defaults for dark theme
Chart.defaults.color = '#adb5bd';
Chart.defaults.borderColor = 'rgba(255, 255, 255, 0.1)';

// User Growth Chart
const userGrowthCtx = document.getElementById('userGrowthChart');
if (userGrowthCtx) {
    new Chart(userGrowthCtx, {
        type: 'line',
        data: {
            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May'],
            datasets: [{
                label: 'New Users',
                data: [18, 25, 40, 65, 74],
                borderColor: '#3498db',
                backgroundColor: 'rgba(52, 152, 219, 0.1)',
                tension: 0.4,
                fill: true
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: false
                },
                tooltip: {
                    mode: 'index',
                    intersect: false
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    grid: {
                        color: 'rgba(255, 255, 255, 0.05)'
                    }
                },
                x: {
                    grid: {
                        display: false
                    }
                }
            }
        }
    });
}

// Token Distribution Chart
const tokenDistributionCtx = document.getElementById('tokenDistributionChart');
if (tokenDistributionCtx) {
    new Chart(tokenDistributionCtx, {
        type: 'doughnut',
        data: {
            labels: ['Top 10%', 'Next 20%', 'Middle 30%', 'Bottom 40%'],
            datasets: [{
                data: [45, 30, 15, 10],
                backgroundColor: [
                    '#f39c12', // Yellow
                    '#3498db', // Blue
                    '#2ecc71', // Green
                    '#9b59b6'  // Purple
                ],
                borderWidth: 0
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            cutout: '70%',
            plugins: {
                legend: {
                    position: 'right',
                    labels: {
                        padding: 15,
                        usePointStyle: true,
                        pointStyle: 'circle'
                    }
                }
            }
        }
    });
}

// Activity Breakdown Chart
const activityCtx = document.getElementById('activityChart');
if (activityCtx) {
    new Chart(activityCtx, {
        type: 'bar',
        data: {
            labels: ['Mining', 'Art Creation', 'Building', 'Market Trading', 'Mini-Games'],
            datasets: [{
                label: 'Activity Distribution',
                data: [35, 25, 15, 10, 15],
                backgroundColor: [
                    'rgba(52, 152, 219, 0.7)', // Blue
                    'rgba(155, 89, 182, 0.7)', // Purple
                    'rgba(46, 204, 113, 0.7)', // Green
                    'rgba(230, 126, 34, 0.7)', // Orange
                    'rgba(241, 196, 15, 0.7)'  // Yellow
                ],
                borderWidth: 0,
                borderRadius: 4
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: false
                }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    grid: {
                        color: 'rgba(255, 255, 255, 0.05)'
                    },
                    ticks: {
                        callback: function(value) {
                            return value + '%';
                        }
                    }
                },
                x: {
                    grid: {
                        display: false
                    }
                }
            }
        }
    });
}

// Market Price Chart
const marketCtx = document.getElementById('marketPriceChart');
if (marketCtx) {
    new Chart(marketCtx, {
        type: 'line',
        data: {
            labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4', 'Week 5'],
            datasets: [
                {
                    label: 'Pixels',
                    data: [2.10, 2.25, 2.30, 2.38, 2.45],
                    borderColor: '#3498db',
                    tension: 0.3,
                    pointRadius: 3
                },
                {
                    label: 'Materials',
                    data: [6.20, 6.10, 5.90, 5.85, 5.80],
                    borderColor: '#f39c12',
                    tension: 0.3,
                    pointRadius: 3
                },
                {
                    label: 'Gems',
                    data: [18.50, 19.80, 21.20, 22.90, 24.60],
                    borderColor: '#9b59b6',
                    tension: 0.3,
                    pointRadius: 3
                }
            ]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'top',
                    labels: {
                        usePointStyle: true,
                        pointStyle: 'circle',
                        padding: 15
                    }
                },
                tooltip: {
                    mode: 'index',
                    intersect: false,
                    callbacks: {
                        label: function(context) {
                            return context.dataset.label + ': ' + context.raw + ' $PXPT';
                        }
                    }
                }
            },
            scales: {
                y: {
                    beginAtZero: false,
                    grid: {
                        color: 'rgba(255, 255, 255, 0.05)'
                    },
                    ticks: {
                        callback: function(value) {
                            return value + ' $PXPT';
                        }
                    }
                },
                x: {
                    grid: {
                        display: false
                    }
                }
            }
        }
    });
}

// User Search & Filtering
const userSearch = document.getElementById('userSearch');
const filterActivity = document.getElementById('filterActivity');
const filterWallet = document.getElementById('filterWallet');
const applyFilters = document.getElementById('applyFilters');
const userTable = document.getElementById('userTable');

if (applyFilters && userTable) {
    applyFilters.addEventListener('click', function() {
        const searchTerm = userSearch?.value?.toLowerCase() || '';
        const activityFilter = filterActivity?.value || 'all';
        const walletFilter = filterWallet?.value || 'all';
        
        const rows = userTable.querySelectorAll('tbody tr');
        
        rows.forEach(row => {
            const username = row.querySelector('td:nth-child(2)').textContent.toLowerCase();
            const hasWallet = !row.querySelector('td:nth-child(4)').textContent.includes('Not set');
            
            // Search filter
            const matchesSearch = searchTerm === '' || username.includes(searchTerm);
            
            // Wallet filter
            let matchesWallet = true;
            if (walletFilter === 'yes') {
                matchesWallet = hasWallet;
            } else if (walletFilter === 'no') {
                matchesWallet = !hasWallet;
            }
            
            // Simple activity filter for demo
            // In reality, this would use server-side filtering
            let matchesActivity = true;
            
            // Show/hide based on combined filters
            if (matchesSearch && matchesWallet && matchesActivity) {
                row.style.display = '';
            } else {
                row.style.display = 'none';
            }
        });
    });
}

// Select all checkbox functionality
const selectAllUsers = document.getElementById('selectAllUsers');
if (selectAllUsers && userTable) {
    selectAllUsers.addEventListener('change', function() {
        const checkboxes = userTable.querySelectorAll('.user-select');
        checkboxes.forEach(checkbox => {
            checkbox.checked = selectAllUsers.checked;
        });
    });
}

// Tab switching functionality for content management section
document.addEventListener('DOMContentLoaded', function() {
    // Content management tab navigation
    const contentNavItems = document.querySelectorAll('.content-nav .list-group-item');
    if (contentNavItems.length > 0) {
        contentNavItems.forEach(item => {
            item.addEventListener('click', function(e) {
                contentNavItems.forEach(navItem => {
                    navItem.classList.remove('active');
                });
                this.classList.add('active');
            });
        });
    }
    
    // Add tab activation listeners for mobile nav
    const mobileNavItems = document.querySelectorAll('[id$="-tab-mobile"]');
    if (mobileNavItems.length > 0) {
        mobileNavItems.forEach(item => {
            item.addEventListener('click', function() {
                // Set corresponding desktop tab active state
                const targetId = this.getAttribute('data-bs-target');
                const desktopTab = document.querySelector(`[data-bs-target="${targetId}"]:not([id$="-mobile"])`);
                if (desktopTab) {
                    const tabTrigger = new bootstrap.Tab(desktopTab);
                    tabTrigger.show();
                }
                
                // Remove active class from all mobile items
                mobileNavItems.forEach(navItem => {
                    navItem.classList.remove('active');
                });
                
                // Add active class to clicked item
                this.classList.add('active');
            });
        });
    }
}

// Airdrop Countdown Timer
const airdropCountdown = document.getElementById('airdropCountdown');
if (airdropCountdown) {
    const targetDate = new Date('May 10, 2025 12:00:00').getTime();
    
    function updateCountdown() {
        const now = new Date().getTime();
        const distance = targetDate - now;
        
        const days = Math.floor(distance / (1000 * 60 * 60 * 24));
        const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        
        airdropCountdown.textContent = days + ' days ' + hours + ' hours';
        
        setTimeout(updateCountdown, 3600000); // Update every hour
    }
    
    updateCountdown();
}
</script>

<!-- Modal Definitions for Content Management -->
<!-- Content Preview Modal -->
<div class="modal fade" id="contentPreviewModal" tabindex="-1" aria-labelledby="contentPreviewModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header bg-dark">
                <h5 class="modal-title" id="contentPreviewModalLabel">Content Preview</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="preview-container p-4">
                    <p class="text-center">Preview of selected content will appear here.</p>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<!-- Create Task Modal -->
<div class="modal fade" id="createTaskModal" tabindex="-1" aria-labelledby="createTaskModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header bg-dark">
                <h5 class="modal-title" id="createTaskModalLabel">Create New Task</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="mb-3">
                        <label class="form-label">Task Name</label>
                        <input type="text" class="form-control" placeholder="Enter task name">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Description</label>
                        <textarea class="form-control" rows="3" placeholder="Enter task description"></textarea>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label class="form-label">Task Type</label>
                            <select class="form-select">
                                <option value="one_time">One-time</option>
                                <option value="daily">Daily</option>
                                <option value="weekly">Weekly</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Objective Type</label>
                            <select class="form-select">
                                <option value="registration">Registration</option>
                                <option value="login">Login</option>
                                <option value="mining">Mining</option>
                                <option value="pixel_art">Pixel Art</option>
                                <option value="building">Building</option>
                                <option value="collection">Collection</option>
                                <option value="referral">Referral</option>
                                <option value="market">Market</option>
                            </select>
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label class="form-label">Target Value</label>
                            <input type="number" class="form-control" value="1">
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Active</label>
                            <div class="form-check form-switch mt-2">
                                <input class="form-check-input" type="checkbox" id="taskActiveSwitch" checked>
                                <label class="form-check-label" for="taskActiveSwitch">Task is active</label>
                            </div>
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-4">
                            <label class="form-label">Token Reward</label>
                            <input type="number" class="form-control" value="10">
                        </div>
                        <div class="col-md-4">
                            <label class="form-label">Pixel Reward</label>
                            <input type="number" class="form-control" value="0">
                        </div>
                        <div class="col-md-4">
                            <label class="form-label">XP Reward</label>
                            <input type="number" class="form-control" value="20">
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary">Create Task</button>
            </div>
        </div>
    </div>
</div>

<!-- Edit Task Modal -->
<div class="modal fade" id="editTaskModal" tabindex="-1" aria-labelledby="editTaskModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header bg-dark">
                <h5 class="modal-title" id="editTaskModalLabel">Edit Task</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="mb-3">
                        <label class="form-label">Task Name</label>
                        <input type="text" class="form-control" placeholder="Enter task name" value="Mining Master">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Description</label>
                        <textarea class="form-control" rows="3" placeholder="Enter task description">Mine 100 pixels in a single day</textarea>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label class="form-label">Task Type</label>
                            <select class="form-select">
                                <option value="one_time">One-time</option>
                                <option value="daily" selected>Daily</option>
                                <option value="weekly">Weekly</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Objective Type</label>
                            <select class="form-select">
                                <option value="registration">Registration</option>
                                <option value="login">Login</option>
                                <option value="mining" selected>Mining</option>
                                <option value="pixel_art">Pixel Art</option>
                                <option value="building">Building</option>
                                <option value="collection">Collection</option>
                                <option value="referral">Referral</option>
                                <option value="market">Market</option>
                            </select>
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label class="form-label">Target Value</label>
                            <input type="number" class="form-control" value="100">
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Active</label>
                            <div class="form-check form-switch mt-2">
                                <input class="form-check-input" type="checkbox" id="editTaskActiveSwitch" checked>
                                <label class="form-check-label" for="editTaskActiveSwitch">Task is active</label>
                            </div>
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-4">
                            <label class="form-label">Token Reward</label>
                            <input type="number" class="form-control" value="15">
                        </div>
                        <div class="col-md-4">
                            <label class="form-label">Pixel Reward</label>
                            <input type="number" class="form-control" value="50">
                        </div>
                        <div class="col-md-4">
                            <label class="form-label">XP Reward</label>
                            <input type="number" class="form-control" value="25">
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary">Save Changes</button>
            </div>
        </div>
    </div>
</div>

<!-- Create Announcement Modal -->
<div class="modal fade" id="createAnnouncementModal" tabindex="-1" aria-labelledby="createAnnouncementModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header bg-dark">
                <h5 class="modal-title" id="createAnnouncementModalLabel">Create Announcement</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="mb-3">
                        <label class="form-label">Title</label>
                        <input type="text" class="form-control" placeholder="Announcement title">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Content</label>
                        <textarea class="form-control" rows="5" placeholder="Announcement content"></textarea>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label class="form-label">Priority</label>
                            <select class="form-select">
                                <option value="low">Low</option>
                                <option value="medium" selected>Medium</option>
                                <option value="high">High</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Publish Date</label>
                            <input type="date" class="form-control">
                        </div>
                    </div>
                    <div class="form-check mb-3">
                        <input class="form-check-input" type="checkbox" id="sendTelegramCheck" checked>
                        <label class="form-check-label" for="sendTelegramCheck">
                            Send to Telegram bot
                        </label>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary">Create Announcement</button>
            </div>
        </div>
    </div>
</div>

<!-- Edit Announcement Modal -->
<div class="modal fade" id="editAnnouncementModal" tabindex="-1" aria-labelledby="editAnnouncementModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header bg-dark">
                <h5 class="modal-title" id="editAnnouncementModalLabel">Edit Announcement</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="mb-3">
                        <label class="form-label">Title</label>
                        <input type="text" class="form-control" placeholder="Announcement title" value="New Features Released">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Content</label>
                        <textarea class="form-control" rows="5" placeholder="Announcement content">We've added new mining mechanics and pixel art creation tools. Check them out!</textarea>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label class="form-label">Priority</label>
                            <select class="form-select">
                                <option value="low">Low</option>
                                <option value="medium" selected>Medium</option>
                                <option value="high">High</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Publish Date</label>
                            <input type="date" class="form-control" value="2025-05-01">
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary">Save Changes</button>
            </div>
        </div>
    </div>
</div>

<!-- Create Event Modal -->
<div class="modal fade" id="createEventModal" tabindex="-1" aria-labelledby="createEventModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header bg-dark">
                <h5 class="modal-title" id="createEventModalLabel">Create Game Event</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="mb-3">
                        <label class="form-label">Event Name</label>
                        <input type="text" class="form-control" placeholder="Event name">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Description</label>
                        <textarea class="form-control" rows="3" placeholder="Event description"></textarea>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Event Type</label>
                        <select class="form-select">
                            <option value="seasonal">Seasonal</option>
                            <option value="special">Special</option>
                            <option value="crisis">Crisis (Negative)</option>
                            <option value="boom">Economic Boom</option>
                        </select>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label class="form-label">Start Date</label>
                            <input type="date" class="form-control">
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">End Date</label>
                            <input type="date" class="form-control">
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label class="form-label">Mining Multiplier</label>
                            <input type="number" step="0.1" class="form-control" value="1.0">
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Art Multiplier</label>
                            <input type="number" step="0.1" class="form-control" value="1.0">
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label class="form-label">Building Multiplier</label>
                            <input type="number" step="0.1" class="form-control" value="1.0">
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Market Fee Multiplier</label>
                            <input type="number" step="0.1" class="form-control" value="1.0">
                        </div>
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label class="form-label">Affected Resources</label>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="affectTokensCreate" checked>
                                <label class="form-check-label" for="affectTokensCreate">Tokens</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="affectPixelsCreate">
                                <label class="form-check-label" for="affectPixelsCreate">Pixels</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="affectMaterialsCreate">
                                <label class="form-check-label" for="affectMaterialsCreate">Materials</label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="affectGemsCreate">
                                <label class="form-check-label" for="affectGemsCreate">Gems</label>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Event Status</label>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="eventActiveSwitch" checked>
                                <label class="form-check-label" for="eventActiveSwitch">Event is active</label>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary">Create Event</button>
            </div>
        </div>
    </div>
</div>

<!-- Create Help Article Modal -->
<div class="modal fade" id="createHelpModal" tabindex="-1" aria-labelledby="createHelpModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header bg-dark">
                <h5 class="modal-title" id="createHelpModalLabel">Create Help Article</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="mb-3">
                        <label class="form-label">Title</label>
                        <input type="text" class="form-control" placeholder="Help article title">
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label class="form-label">Category</label>
                            <select class="form-select">
                                <option value="Tutorial">Tutorial</option>
                                <option value="Gameplay">Gameplay</option>
                                <option value="Strategy">Strategy</option>
                                <option value="FAQ">FAQ</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Difficulty</label>
                            <select class="form-select">
                                <option value="Beginner">Beginner</option>
                                <option value="Intermediate">Intermediate</option>
                                <option value="Advanced">Advanced</option>
                            </select>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Content</label>
                        <div class="btn-toolbar mb-2" role="toolbar">
                            <div class="btn-group me-2" role="group">
                                <button type="button" class="btn btn-sm btn-outline-secondary"><i class="fas fa-bold"></i></button>
                                <button type="button" class="btn btn-sm btn-outline-secondary"><i class="fas fa-italic"></i></button>
                                <button type="button" class="btn btn-sm btn-outline-secondary"><i class="fas fa-underline"></i></button>
                            </div>
                            <div class="btn-group me-2" role="group">
                                <button type="button" class="btn btn-sm btn-outline-secondary"><i class="fas fa-list-ul"></i></button>
                                <button type="button" class="btn btn-sm btn-outline-secondary"><i class="fas fa-list-ol"></i></button>
                            </div>
                            <div class="btn-group" role="group">
                                <button type="button" class="btn btn-sm btn-outline-secondary"><i class="fas fa-link"></i></button>
                                <button type="button" class="btn btn-sm btn-outline-secondary"><i class="fas fa-image"></i></button>
                            </div>
                        </div>
                        <textarea class="form-control" rows="12" placeholder="Write your help article content here..."></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary">Create Article</button>
            </div>
        </div>
    </div>
</div>

<!-- View Help Article Modal -->
<div class="modal fade" id="viewHelpModal" tabindex="-1" aria-labelledby="viewHelpModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header bg-dark">
                <h5 class="modal-title" id="viewHelpModalLabel">Getting Started</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="d-flex justify-content-between mb-3">
                    <span class="badge bg-info">Tutorial</span>
                    <span class="text-muted">Beginner</span>
                </div>
                <div class="content-preview">
                    <h3>Getting Started with Pixel Plaza Token</h3>
                    <p>Welcome to Pixel Plaza Token! This guide will help you get started with our game and learn the basics of earning tokens, building your empire, and preparing for the airdrop.</p>
                    
                    <h4>Step 1: Daily Check-ins</h4>
                    <p>Make sure to check in daily to receive your daily tokens. Consecutive check-ins will increase your streak bonus!</p>
                    
                    <h4>Step 2: Mining Pixels</h4>
                    <p>Start by mining pixels. Click the "Mine" button on the dashboard to earn pixels. These are the basic resource in the game.</p>
                    
                    <h4>Step 3: Create Pixel Art</h4>
                    <p>Use your pixels to create pixel art. Each creation earns you tokens and improves your art skill.</p>
                    
                    <h4>Step 4: Build Your Empire</h4>
                    <p>Invest in buildings to generate passive income. Start with a Pixel Mine to increase your pixel production.</p>
                    
                    <h4>Step 5: Register Your Wallet</h4>
                    <p>Don't forget to register your ERC-20 wallet to be eligible for the airdrop!</p>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary">Edit Article</button>
            </div>
        </div>
    </div>
</div>

<!-- Edit Help Article Modal -->
<div class="modal fade" id="editHelpModal" tabindex="-1" aria-labelledby="editHelpModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header bg-dark">
                <h5 class="modal-title" id="editHelpModalLabel">Edit Help Article</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="mb-3">
                        <label class="form-label">Title</label>
                        <input type="text" class="form-control" value="Getting Started">
                    </div>
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label class="form-label">Category</label>
                            <select class="form-select">
                                <option value="Tutorial" selected>Tutorial</option>
                                <option value="Gameplay">Gameplay</option>
                                <option value="Strategy">Strategy</option>
                                <option value="FAQ">FAQ</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Difficulty</label>
                            <select class="form-select">
                                <option value="Beginner" selected>Beginner</option>
                                <option value="Intermediate">Intermediate</option>
                                <option value="Advanced">Advanced</option>
                            </select>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Content</label>
                        <div class="btn-toolbar mb-2" role="toolbar">
                            <div class="btn-group me-2" role="group">
                                <button type="button" class="btn btn-sm btn-outline-secondary"><i class="fas fa-bold"></i></button>
                                <button type="button" class="btn btn-sm btn-outline-secondary"><i class="fas fa-italic"></i></button>
                                <button type="button" class="btn btn-sm btn-outline-secondary"><i class="fas fa-underline"></i></button>
                            </div>
                            <div class="btn-group me-2" role="group">
                                <button type="button" class="btn btn-sm btn-outline-secondary"><i class="fas fa-list-ul"></i></button>
                                <button type="button" class="btn btn-sm btn-outline-secondary"><i class="fas fa-list-ol"></i></button>
                            </div>
                            <div class="btn-group" role="group">
                                <button type="button" class="btn btn-sm btn-outline-secondary"><i class="fas fa-link"></i></button>
                                <button type="button" class="btn btn-sm btn-outline-secondary"><i class="fas fa-image"></i></button>
                            </div>
                        </div>
                        <textarea class="form-control" rows="12">
Getting Started with Pixel Plaza Token

Welcome to Pixel Plaza Token! This guide will help you get started with our game and learn the basics of earning tokens, building your empire, and preparing for the airdrop.

Step 1: Daily Check-ins
Make sure to check in daily to receive your daily tokens. Consecutive check-ins will increase your streak bonus!

Step 2: Mining Pixels
Start by mining pixels. Click the "Mine" button on the dashboard to earn pixels. These are the basic resource in the game.

Step 3: Create Pixel Art
Use your pixels to create pixel art. Each creation earns you tokens and improves your art skill.

Step 4: Build Your Empire
Invest in buildings to generate passive income. Start with a Pixel Mine to increase your pixel production.

Step 5: Register Your Wallet
Don't forget to register your ERC-20 wallet to be eligible for the airdrop!
                        </textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary">Save Changes</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}
